zabbix_export:
  version: '6.0'
  date: '2024-11-14T04:23:08Z'
  groups:
    -
      uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  templates:
    -
      uuid: ae73bd07cfc747818e439d08a274961d
      template: 'POLYUS Template OS Linux by Zabbix agent'
      name: 'POLYUS Template OS Linux by Zabbix agent'
      description: |
        Official Linux template. Requires agent of Zabbix 3.0.14, 3.4.5 and 4.0.0 or newer.
        
        Known Issues:
        
          Description: Network discovery. Zabbix agent as of 4.2 doesn't support items such as net.if.status, net.if.speed.
        
        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux
        
        Template tooling version used: 0.34
      templates:
        -
          name: 'POLYUS Module ICMP Ping'
      groups:
        -
          name: 'Templates/Operating systems'
      items:
        -
          uuid: 6b29dcdf4d89478f91314d5bf19c1772
          name: 'Host name of Zabbix agent running'
          key: agent.hostname
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: 'Monitoring agent'
            -
              tag: component
              value: system
        -
          uuid: ebb764cdd99e41ad83225c30fee2a7f0
          name: 'Zabbix agent ping'
          key: agent.ping
          history: 7d
          description: 'The agent always returns 1 for this item. It could be used in combination with nodata() for availability check.'
          valuemap:
            name: 'Zabbix agent ping status'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 2m
          tags:
            -
              tag: Application
              value: 'Monitoring agent'
            -
              tag: component
              value: system
        -
          uuid: ac58cc9b25504703b2ebc6ed7dfdbcac
          name: 'Version of Zabbix agent running'
          key: agent.version
          delay: 1h
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: 'Monitoring agent'
            -
              tag: component
              value: application
        -
          uuid: 6f3dd7d01c6d4495b55cd1276e52a6aa
          name: 'Maximum number of open file descriptors'
          key: kernel.maxfiles
          delay: 1h
          history: 7d
          status: DISABLED
          description: 'It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: c39d397e9181479bbf0df4fbc84dca28
              expression: 'last(/POLYUS Template OS Linux by Zabbix agent/kernel.maxfiles)<{$KERNEL.MAXFILES.MIN}'
              name: 'Configured max number of open filedescriptors is too low (< {$KERNEL.MAXFILES.MIN})'
              priority: INFO
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: fa7388ce732c41a983a4411f320aadb3
          name: 'Maximum number of processes'
          key: kernel.maxproc
          delay: 1h
          history: 7d
          status: DISABLED
          description: 'It could be increased by using sysctrl utility or modifying file /etc/sysctl.conf.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: f737a92278134bd2a2938665b962fc66
              expression: 'last(/POLYUS Template OS Linux by Zabbix agent/kernel.maxproc)<{$KERNEL.MAXPROC.MIN}'
              name: 'Configured max number of processes is too low (< {$KERNEL.MAXPROC.MIN})'
              priority: INFO
              dependencies:
                -
                  name: 'Getting closer to process limit (over 80% used)'
                  expression: 'last(/POLYUS Template OS Linux by Zabbix agent/proc.num)/last(/POLYUS Template OS Linux by Zabbix agent/kernel.maxproc)*100>80'
              tags:
                -
                  tag: scope
                  value: performance
        -
          uuid: e400f7b6a8c14d89b1326c31f1250cd5
          name: 'Number of processes'
          key: proc.num
          history: 7d
          status: DISABLED
          tags:
            -
              tag: component
              value: system
        -
          uuid: 9a989ed34dd5456ca5754dcf233548c7
          name: 'Number of running processes'
          key: 'proc.num[,,run]'
          history: 7d
          status: DISABLED
          tags:
            -
              tag: component
              value: system
        -
          uuid: 3e4a5288610d4d1691cdc8bb3d2cd7d4
          name: 'System boot time'
          key: system.boottime
          delay: 15m
          history: 7d
          units: unixtime
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
        -
          uuid: edb98b69fd1943dfb638499dcc7b5127
          name: 'Interrupts per second'
          key: system.cpu.intr
          history: 7d
          value_type: FLOAT
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 869908af8baf42c8a8f3cbe02716104e
          name: 'Load average (1m avg)'
          key: 'system.cpu.load[all,avg1]'
          history: 7d
          value_type: FLOAT
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 68a33d145b994668ae4653a229b16a9d
          name: 'Load average (5m avg)'
          key: 'system.cpu.load[all,avg5]'
          history: 7d
          value_type: FLOAT
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 286ae566cbc94e3db128ea69f229b713
          name: 'Load average (15m avg)'
          key: 'system.cpu.load[all,avg15]'
          history: 7d
          value_type: FLOAT
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 20f9c7e839354f53814bef56dbdb0b2d
          name: 'Number of CPUs'
          key: system.cpu.num
          history: 7d
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 9e00bff47b094ba098387ea45339acf1
          name: 'Context switches per second'
          key: system.cpu.switches
          history: 7d
          value_type: FLOAT
          preprocessing:
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 9d425d263f754db0bf9efac86c88a982
          name: 'CPU utilization'
          type: DEPENDENT
          key: system.cpu.util
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'CPU utilization in %'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  //Calculate utilization
                  return (100 - value)
          master_item:
            key: 'system.cpu.util[,idle]'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
          triggers:
            -
              uuid: d6fadd5b31cd45f980200d2502b68f6b
              expression: 'min(/POLYUS Template OS Linux by Zabbix agent/system.cpu.util,{$CPU.UTIL.CRIT.TIME.INTERVAL})>{$CPU.UTIL.CRIT}'
              name: 'High CPU utilization (over {$CPU.UTIL.CRIT}% for {$CPU.UTIL.CRIT.TIME.INTERVAL})'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: |
                Last Value: {ITEM.LASTVALUE1}
                CPU utilization is too high. The system might be slow to respond.
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Load average is too high (per CPU load over {$CPU.LOAD_AVG_PER_CPU.MAX.WARN} for {$CPU.LOAD_AVG_PER_CPU.MAX.WARN.INTERVAL})'
                  expression: |
                    min(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg1],{$CPU.LOAD_AVG_PER_CPU.MAX.WARN.INTERVAL})/last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.num)>{$CPU.LOAD_AVG_PER_CPU.MAX.WARN}
                    and last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg5])>0
                    and last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg15])>0
              tags:
                -
                  tag: scope
                  value: performance
            -
              uuid: 339e8dd913034f53b0e2d154af78f688
              expression: 'min(/POLYUS Template OS Linux by Zabbix agent/system.cpu.util,{$CPU.UTIL.CRIT.TIME.INTERVAL.SIEM})>{$CPU.UTIL.CRIT.SIEM}'
              name: 'High CPU utilization for siem (over {$CPU.UTIL.CRIT.SIEM}% for {$CPU.UTIL.CRIT.TIME.INTERVAL.SIEM})'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              description: |
                Last Value: {ITEM.LASTVALUE1}
                CPU utilization is too high. The system might be slow to respond.
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: performance
                -
                  tag: siem
                  value: 'true'
        -
          uuid: 521691a4a6044c77b0070abf7255000c
          name: 'CPU guest time'
          key: 'system.cpu.util[,guest]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Guest  time (time  spent  running  a  virtual  CPU  for  a  guest  operating  system)'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: fab052704479464fb1a16361c080e948
          name: 'CPU guest nice time'
          key: 'system.cpu.util[,guest_nice]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Time spent running a niced guest (virtual CPU for guest operating systems under the control of the Linux kernel)'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: b797057e57da418e8c7fe846ed3e93b2
          name: 'CPU idle time'
          key: 'system.cpu.util[,idle]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent doing nothing.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 52e355888df6408d8dd26f006ccbf155
          name: 'CPU interrupt time'
          key: 'system.cpu.util[,interrupt]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of time the CPU has been servicing hardware interrupts.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 47ba619b5df5424b85d8974136e2966d
          name: 'CPU iowait time'
          key: 'system.cpu.util[,iowait]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Amount of time the CPU has been waiting for I/O to complete.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: e6b6e2f8f5014f49b910ad9f90354f45
          name: 'CPU nice time'
          key: 'system.cpu.util[,nice]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running users'' processes that have been niced.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: a47a4d8cabfa4343a9d3a301a1c31d51
          name: 'CPU softirq time'
          key: 'system.cpu.util[,softirq]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of time the CPU has been servicing software interrupts.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: a1545573f297485ea7c95d20a914fd1d
          name: 'CPU steal time'
          key: 'system.cpu.util[,steal]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The amount of CPU ''stolen'' from this virtual machine by the hypervisor for other tasks (such as running another virtual machine).'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 791d3f2d8e8541cc99708985376df4d9
          name: 'CPU system time'
          key: 'system.cpu.util[,system]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running the kernel and its processes.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 99a50b7e1baf40c19941b5e6246207a5
          name: 'CPU user time'
          key: 'system.cpu.util[,user]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The time the CPU has spent running users'' processes that are not niced.'
          tags:
            -
              tag: Application
              value: CPU
            -
              tag: component
              value: cpu
        -
          uuid: 917fe4bfb9da41b386b25c4730d97c67
          name: 'System name'
          key: system.hostname
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'System host name.'
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: b0c3b84c548041e7be1b99c43021a84a
              expression: '(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#1)<>last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#2))=1 and length(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname))>0'
              name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
                -
                  tag: scope
                  value: security
        -
          uuid: 47a95e9b754d4a5499eedcc884e1790c
          name: 'System local time'
          key: system.localtime
          history: 7d
          units: unixtime
          description: 'System local time of the host.'
          tags:
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 9afbbdf37cdb4988a2338794b0c104d5
              expression: 'fuzzytime(/POLYUS Template OS Linux by Zabbix agent/system.localtime,{$SYSTEM.FUZZYTIME.MAX})=0'
              name: 'System time is out of sync (diff with Zabbix server > {$SYSTEM.FUZZYTIME.MAX}s)'
              status: DISABLED
              priority: WARNING
              description: 'The host system time is different from the Zabbix server time.'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: performance
        -
          uuid: bc1772b97b854879bb27464355e9ebe1
          name: 'Operating System Version'
          key: 'system.run["cat /etc/os-release|grep PRETTY_NAME"]'
          delay: 1h
          trends: '0'
          status: DISABLED
          value_type: TEXT
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'PRETTY_NAME=\"(.*)\"'
                - \1
        -
          uuid: d54b8566b9214ca9ba488f7bd2ea5a87
          name: 'Operating system architecture'
          key: system.sw.arch
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Operating system architecture of the host.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: os
        -
          uuid: 7b9e2f789178412e8dab2433a61b63c2
          name: 'Operating system'
          key: system.sw.os
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: os
          triggers:
            -
              uuid: ba519aad89854d0aac5b8a989dabf156
              expression: '(last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os,#1)<>last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os,#2))=1 and length(last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os))>0'
              recovery_mode: NONE
              name: 'Operating system description has changed'
              status: DISABLED
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'System name has changed (new name: {ITEM.VALUE})'
                  expression: '(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#1)<>last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#2))=1 and length(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname))>0'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 5850191879a74b549379b8298eb5db40
          name: 'Software installed'
          key: system.sw.packages
          delay: 1h
          history: 2w
          trends: '0'
          status: DISABLED
          value_type: TEXT
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: os
        -
          uuid: a6e84551558d4ca083bf72e508f74dd7
          name: 'Free swap space'
          key: 'system.swap.size[,free]'
          history: 7d
          units: B
          description: 'The free space of swap volume/file in bytes.'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
            -
              tag: component
              value: swap
        -
          uuid: 4610c06a68b941b381f0013ea90a9175
          name: 'Free swap space in %'
          key: 'system.swap.size[,pfree]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The free space of swap volume/file in percent.'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
            -
              tag: component
              value: swap
        -
          uuid: a2a6f0b28fe343b081e222de57bb1980
          name: 'Total swap space'
          key: 'system.swap.size[,total]'
          history: 7d
          units: B
          description: 'The total space of swap volume/file in bytes.'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
            -
              tag: component
              value: swap
        -
          uuid: 7fb156a9a47a48349f33f3b44b9adec3
          name: 'System description'
          key: system.uname
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'The information as normally returned by ''uname -a''.'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: component
              value: system
        -
          uuid: 1e6bc937d0b046c6bddd049aab09d744
          name: 'System uptime'
          key: system.uptime
          delay: 5m
          history: 2w
          trends: '0'
          units: uptime
          description: 'System uptime in ''N days, hh:mm:ss'' format.'
          tags:
            -
              tag: Application
              value: Status
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 6a66b46907e9485b907b58257f7fe8f0
              expression: 'last(/POLYUS Template OS Linux by Zabbix agent/system.uptime)<30m'
              name: '{HOST.NAME} has been restarted (uptime < 30m)'
              priority: WARNING
              description: 'The host uptime is less than 30 minutes'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: notice
        -
          uuid: 762343983a3b42eaa00690a306fb8ae3
          name: 'Used swap space in %'
          type: DEPENDENT
          key: 'system.usedswap.size[,pused]'
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'The used space of swap volume/file in percent.'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - 'return (100 - value)'
          master_item:
            key: 'system.swap.size[,pfree]'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
        -
          uuid: d10d109bb23b442a873cb58478cb91d1
          name: 'Number of logged in users'
          key: system.users.num
          history: 7d
          status: DISABLED
          description: 'Number of users who are currently logged in.'
          tags:
            -
              tag: component
              value: environment
        -
          uuid: d452b7581f5e4eae961371dc9fba76c0
          name: 'Checksum of /etc/passwd'
          key: 'vfs.file.cksum[/etc/passwd]'
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: component
              value: environment
          triggers:
            -
              uuid: 79aec699cf1c44efbae2892ba996a714
              expression: '(last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.cksum[/etc/passwd],#1)<>last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.cksum[/etc/passwd],#2))>0'
              name: '/etc/passwd has been changed'
              status: DISABLED
              priority: INFO
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Operating system description has changed'
                  expression: '(last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os,#1)<>last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os,#2))=1 and length(last(/POLYUS Template OS Linux by Zabbix agent/system.sw.os))>0'
                -
                  name: 'System name has changed (new name: {ITEM.VALUE})'
                  expression: '(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#1)<>last(/POLYUS Template OS Linux by Zabbix agent/system.hostname,#2))=1 and length(last(/POLYUS Template OS Linux by Zabbix agent/system.hostname))>0'
              tags:
                -
                  tag: scope
                  value: security
        -
          uuid: ed3054b1b22a4143882cd42a802865ab
          name: 'Available memory'
          key: 'vm.memory.size[available]'
          history: 7d
          units: B
          description: 'Available memory, in Linux, available = free + buffers + cache. On other platforms calculation may vary. See also: https://www.zabbix.com/documentation/current/manual/appendix/items/vm.memory.size_params'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
        -
          uuid: e7b231121ecf4991a5f83e337d7faca4
          name: 'Memory utilization'
          key: 'vm.memory.size[pavailable]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: 'Memory used percentage is calculated as (100-pavailable)'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - 'return (100-value);'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
          triggers:
            -
              uuid: 5dec8f54fa214cedb76d0344bc5146e3
              expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[pavailable],{$MEM.UTIL.CRIT.PERIOD})>{$MEM.UTIL.MAX}'
              name: 'High memory utilization ( >{$MEM.UTIL.MAX}% for {$MEM.UTIL.CRIT.PERIOD})'
              opdata: 'Used: {ITEM.LASTVALUE1}'
              priority: AVERAGE
              description: |
                The system is running out of free memory.
                Last Used: {ITEM.LASTVALUE1}
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Available Megabytes of Memory is too low'
                  expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[available],5m)<{$MEM.AVAILABLE.MIN} and last(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[total])>0'
              tags:
                -
                  tag: scope
                  value: performance
            -
              uuid: 535a126abc194c9daad42342cec51699
              expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[pavailable],{$MEM.UTIL.CRIT.PERIOD.SIEM})>{$MEM.UTIL.MAX.SIEM}'
              name: 'High memory utilization for siem ( >{$MEM.UTIL.MAX.SIEM}% for {$MEM.UTIL.CRIT.PERIOD.SIEM})'
              opdata: 'Used: {ITEM.LASTVALUE1}'
              description: |
                The system is running out of free memory.
                Last Used: {ITEM.LASTVALUE1}
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: performance
                -
                  tag: siem
                  value: 'true'
        -
          uuid: e59b5b62a1aa427d9e50468c08648bc4
          name: 'Total memory'
          key: 'vm.memory.size[total]'
          history: 7d
          units: B
          description: 'Total memory in Bytes'
          tags:
            -
              tag: Application
              value: Memory
            -
              tag: component
              value: memory
        -
          uuid: 218abcc518034a3bbd02afa48c43c999
          name: 'Zabbix agent availability'
          type: INTERNAL
          key: 'zabbix[host,agent,available]'
          history: 7d
          description: 'Monitoring agent availability status'
          valuemap:
            name: zabbix.host.available
          tags:
            -
              tag: Application
              value: Status
            -
              tag: component
              value: system
          triggers:
            -
              uuid: 4be27c58e8574b27a4361862247f2dfa
              expression: 'max(/POLYUS Template OS Linux by Zabbix agent/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0'
              name: 'Zabbix agent is not available'
              event_name: 'Zabbix agent is not available (for {$AGENT.TIMEOUT})'
              priority: AVERAGE
              description: 'For passive only agents, host availability is used with {$AGENT.TIMEOUT} as time threshold.'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: availability
      discovery_rules:
        -
          uuid: dc4494e080c74934a28f6a00c0c7c75c
          name: 'Network interface discovery'
          key: net.if.discovery
          delay: 1h
          status: DISABLED
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of network interfaces.'
          item_prototypes:
            -
              uuid: 7052fabe6e8b42ec8b2dee04736b5335
              name: 'Interface {#IFNAME}: Inbound packets discarded'
              key: 'net.if.in["{#IFNAME}",dropped]'
              delay: 3m
              history: 7d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: cc2e066a771543d4a1c9d1a582542e20
              name: 'Interface {#IFNAME}: Inbound packets with errors'
              key: 'net.if.in["{#IFNAME}",errors]'
              delay: 3m
              history: 7d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 3d10bb1618cc459d96bed753c3aae311
              name: 'Interface {#IFNAME}: Bits received'
              key: 'net.if.in["{#IFNAME}"]'
              delay: 3m
              history: 7d
              units: bps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 5b5a896b1b13408cbb00ff3403e0a453
              name: 'Interface {#IFNAME}: Outbound packets discarded'
              key: 'net.if.out["{#IFNAME}",dropped]'
              delay: 3m
              history: 7d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: c21ea8982a1641a1a6ba445b454239fa
              name: 'Interface {#IFNAME}: Outbound packets with errors'
              key: 'net.if.out["{#IFNAME}",errors]'
              delay: 3m
              history: 7d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 6960bfd4d92b486a9be92b4cd2af95f8
              name: 'Interface {#IFNAME}: Bits sent'
              key: 'net.if.out["{#IFNAME}"]'
              delay: 3m
              history: 7d
              units: bps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: 105b00cdd5594f7f81ed42ec6f8dcacc
              name: 'Interface {#IFNAME}: Operational status'
              key: 'vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"]'
              history: 7d
              trends: '0'
              description: |
                Indicates the interface RFC2863 operational state as a string.
                Possible values are:"unknown", "notpresent", "down", "lowerlayerdown", "testing","dormant", "up".
                Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net
              valuemap:
                name: ifOperStatus
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      var newvalue;
                      switch(value) {
                        case "unknown":
                          newvalue = 0;
                          break;
                        case "notpresent":
                          newvalue = 1;
                          break;
                        case "down":
                          newvalue = 2;
                          break;
                        case "lowerlayerdown":
                          newvalue = 3;
                          break;
                        case "testing":
                          newvalue = 4;
                          break;
                        case "dormant":
                          newvalue = 5;
                          break;
                        case "up":
                          newvalue = 6;
                          break;
                        default:
                          newvalue = "Problem parsing interface operstate in JS";
                      }
                      return newvalue;
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                -
                  uuid: be124451af884024b88a46b5203caf3b
                  expression: '{$NET.IF.CONTROL:"{#IFNAME}"}=1 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])=2 and (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#1)<>last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}: Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: availability
            -
              uuid: e12b232c2fc8469f8c9934c041216e43
              name: 'Interface {#IFNAME}: Speed'
              key: 'vfs.file.contents["/sys/class/net/{#IFNAME}/speed"]'
              delay: 5m
              history: 7d
              trends: '0'
              units: bps
              description: |
                Indicates the interface latest or current speed value. Value is an integer representing the link speed in bits/sec.
                This attribute is only valid for interfaces that implement the ethtool get_link_ksettings method (mostly Ethernet).
                Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
            -
              uuid: a8f91a799eb54c048d8939c2c5a7f901
              name: 'Interface {#IFNAME}: Interface type'
              key: 'vfs.file.contents["/sys/class/net/{#IFNAME}/type"]'
              delay: 1h
              history: 7d
              trends: '0'
              description: |
                Indicates the interface protocol type as a decimal value.
                See include/uapi/linux/if_arp.h for all possible values.
                Reference: https://www.kernel.org/doc/Documentation/ABI/testing/sysfs-class-net
              valuemap:
                name: 'Linux::Interface protocol types'
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}'
                -
                  tag: component
                  value: network
                -
                  tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            -
              uuid: 685d9da80a8b459ca6daf89498d7cde9
              expression: |
                change(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])<0 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])>0
                and
                (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/type"])=6 or last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/type"])=1)
                and
                (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])>0 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"],#2)>0) or
                (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])=2)
              name: 'Interface {#IFNAME}: Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}: Link down'
                  expression: '{$NET.IF.CONTROL:"{#IFNAME}"}=1 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])=2 and (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#1)<>last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#2))'
                  recovery_expression: 'last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: performance
            -
              uuid: 2a94b8aed9f5438bb4b3660bcd497837
              expression: |
                (avg(/POLYUS Template OS Linux by Zabbix agent/net.if.in["{#IFNAME}"],15m)>({$NET.IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"]) or
                avg(/POLYUS Template OS Linux by Zabbix agent/net.if.out["{#IFNAME}"],15m)>({$NET.IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])) and
                last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/POLYUS Template OS Linux by Zabbix agent/net.if.in["{#IFNAME}"],15m)<(({$NET.IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"]) and
                avg(/POLYUS Template OS Linux by Zabbix agent/net.if.out["{#IFNAME}"],15m)<(({$NET.IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/speed"])
              name: 'Interface {#IFNAME}: High bandwidth usage (>{$NET.IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}: Link down'
                  expression: '{$NET.IF.CONTROL:"{#IFNAME}"}=1 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])=2 and (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#1)<>last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#2))'
                  recovery_expression: 'last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: performance
            -
              uuid: f6ef67f6cdc643b9ae8a4bcf43390bc0
              expression: |
                min(/POLYUS Template OS Linux by Zabbix agent/net.if.in["{#IFNAME}",errors],5m)>{$NET.IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/POLYUS Template OS Linux by Zabbix agent/net.if.out["{#IFNAME}",errors],5m)>{$NET.IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/POLYUS Template OS Linux by Zabbix agent/net.if.in["{#IFNAME}",errors],5m)<{$NET.IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/POLYUS Template OS Linux by Zabbix agent/net.if.out["{#IFNAME}",errors],5m)<{$NET.IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}: High error rate ( > {$NET.IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$NET.IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}: Link down'
                  expression: '{$NET.IF.CONTROL:"{#IFNAME}"}=1 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])=2 and (last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#1)<>last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"],#2))'
                  recovery_expression: 'last(/POLYUS Template OS Linux by Zabbix agent/vfs.file.contents["/sys/class/net/{#IFNAME}/operstate"])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: performance
          graph_prototypes:
            -
              uuid: 8139ea5e25bd486a8185af1203f8321e
              name: 'Interface {#IFNAME}: Network traffic'
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.in["{#IFNAME}"]'
                -
                  sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.out["{#IFNAME}"]'
                -
                  sortorder: '2'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.out["{#IFNAME}",errors]'
                -
                  sortorder: '3'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.in["{#IFNAME}",errors]'
                -
                  sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.out["{#IFNAME}",dropped]'
                -
                  sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'net.if.in["{#IFNAME}",dropped]'
        -
          uuid: 335fdebc15d24097b309a1d67ff2c3c0
          name: 'Block devices discovery'
          key: vfs.dev.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#DEVTYPE}'
                value: disk
                formulaid: C
          item_prototypes:
            -
              uuid: 02af45c57f0643f88c5c27454ca288bd
              name: '{#DEVNAME}: Disk average queue size (avgqu-sz)'
              type: DEPENDENT
              key: 'vfs.dev.queue_size[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Current average disk queue, the number of requests outstanding on the disk at the time the performance data is collected.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[10]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: 1b234d55ff994119ac7f9bba0f4b2b66
              name: '{#DEVNAME}: Disk read request avg waiting time (r_await)'
              type: CALCULATED
              key: 'vfs.dev.read.await[{#DEVNAME}]'
              history: 7d
              value_type: FLOAT
              units: '!ms'
              params: '(last(//vfs.dev.read.time.rate[{#DEVNAME}])/(last(//vfs.dev.read.rate[{#DEVNAME}])+(last(//vfs.dev.read.rate[{#DEVNAME}])=0)))*1000*(last(//vfs.dev.read.rate[{#DEVNAME}]) > 0)'
              description: 'This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: 2e8f082314d6417eb6e6f81d82439b26
              name: '{#DEVNAME}: Disk read rate'
              type: DEPENDENT
              key: 'vfs.dev.read.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '!r/s'
              description: 'r/s. The number (after merges) of read requests completed per second for the device.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[0]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: bde8263f9c1c46ed84cf25f62dba127d
              name: '{#DEVNAME}: Disk read time (rate)'
              type: DEPENDENT
              key: 'vfs.dev.read.time.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Rate of total read time counter. Used in r_await calculation'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[3]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Zabbix raw items'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: d10ff1b1191649f2a16df965fab4d7de
              name: '{#DEVNAME}: Disk utilization'
              type: DEPENDENT
              key: 'vfs.dev.util[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'This item is the percentage of elapsed time that the selected disk drive was busy servicing read or writes requests.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[9]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.1'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: cf95d69974bf4173ac63c0cdde7e5fb2
              name: '{#DEVNAME}: Disk write request avg waiting time (w_await)'
              type: CALCULATED
              key: 'vfs.dev.write.await[{#DEVNAME}]'
              history: 7d
              value_type: FLOAT
              units: '!ms'
              params: '(last(//vfs.dev.write.time.rate[{#DEVNAME}])/(last(//vfs.dev.write.rate[{#DEVNAME}])+(last(//vfs.dev.write.rate[{#DEVNAME}])=0)))*1000*(last(//vfs.dev.write.rate[{#DEVNAME}]) > 0)'
              description: 'This formula contains two boolean expressions that evaluates to 1 or 0 in order to set calculated metric to zero and to avoid division by zero exception.'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: 1d9380f84037480e946ae20e3c3c2f0b
              name: '{#DEVNAME}: Disk write rate'
              type: DEPENDENT
              key: 'vfs.dev.write.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '!w/s'
              description: 'w/s. The number (after merges) of write requests completed per second for the device.'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[4]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Disk {#DEVNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: 998b330942314a40b643c1abbc54c638
              name: '{#DEVNAME}: Disk write time (rate)'
              type: DEPENDENT
              key: 'vfs.dev.write.time.rate[{#DEVNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              description: 'Rate of total write time counter. Used in w_await calculation'
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[7]'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              master_item:
                key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              tags:
                -
                  tag: Application
                  value: 'Zabbix raw items'
                -
                  tag: component
                  value: storage
                -
                  tag: disk
                  value: '{#DEVNAME}'
            -
              uuid: aff2a96377084a78be353279cb535047
              name: '{#DEVNAME}: Get stats'
              key: 'vfs.file.contents[/sys/block/{#DEVNAME}/stat]'
              history: '0'
              trends: '0'
              value_type: TEXT
              description: 'Get contents of /sys/block/{#DEVNAME}/stat for disk stats.'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return JSON.stringify(value.trim().split(/ +/));'
              tags:
                -
                  tag: component
                  value: raw
          trigger_prototypes:
            -
              uuid: 12bb809fe9934fc8a39d0a5c28802b67
              expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vfs.dev.read.await[{#DEVNAME}],15m) > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"} or min(/POLYUS Template OS Linux by Zabbix agent/vfs.dev.write.await[{#DEVNAME}],15m) > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}'
              name: '{#DEVNAME}: Disk read/write request responses are too high (read > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"} ms for 15m or write > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"} ms for 15m)'
              status: DISABLED
              priority: WARNING
              description: 'This trigger might indicate disk {#DEVNAME} saturation.'
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: performance
          graph_prototypes:
            -
              uuid: 81f6e49eca034752a89da773148d5f9e
              name: '{#DEVNAME}: Disk average waiting time'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.read.await[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.write.await[{#DEVNAME}]'
            -
              uuid: 2a7e54d0448a4f7ca4a6409485807bfe
              name: '{#DEVNAME}: Disk read/write rates'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.read.rate[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.write.rate[{#DEVNAME}]'
            -
              uuid: 0fb2895763924e9f879a6b4351804aa9
              name: '{#DEVNAME}: Disk utilization and queue'
              graph_items:
                -
                  color: 1A7C11
                  yaxisside: RIGHT
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.queue_size[{#DEVNAME}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 2774A4
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.dev.util[{#DEVNAME}]'
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        -
          uuid: 2b7dcc130ea9464fa4f7e638f960d4ec
          name: 'Mounted filesystem discovery'
          key: vfs.fs.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
                formulaid: C
              -
                macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: A
              -
                macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Discovery of file systems of different types.'
          item_prototypes:
            -
              uuid: dc8da54420434728a854213bf3e9ee00
              name: '{#FSNAME}: Free inodes in %'
              key: 'vfs.fs.inode[{#FSNAME},pfree]'
              history: 7d
              value_type: FLOAT
              units: '%'
              preprocessing:
                -
                  type: MATCHES_REGEX
                  parameters:
                    - \d+
                  error_handler: DISCARD_VALUE
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                -
                  uuid: 800fbfa6823845b685b0e0a9799e8f33
                  expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.inode[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    It may become impossible to write to disk if there are no index nodes left.
                    As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: capacity
                    -
                      tag: scope
                      value: performance
                -
                  uuid: 97d805f69a004c6eaf89b707274d1430
                  expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.inode[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}'
                  name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    It may become impossible to write to disk if there are no index nodes left.
                    As symptoms, 'No space left on device' or 'Disk is full' errors may be seen even though free space is available.
                  dependencies:
                    -
                      name: '{#FSNAME}: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                      expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.inode[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  tags:
                    -
                      tag: scope
                      value: capacity
                    -
                      tag: scope
                      value: performance
            -
              uuid: f5ac0cd675804284882a65dffb2c0eb1
              name: '{#FSNAME}: Free space'
              key: 'vfs.fs.size[{#FSNAME},free]'
              history: 7d
              units: B
              description: 'Free storage in Bytes'
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: 2ab0b6cc05c746fba42e10f34ad75513
              name: '{#FSNAME}: Free space in %'
              key: 'vfs.fs.size[{#FSNAME},pfree]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: 'Free storage in percent'
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: 11b9b2c794c74cc9963fb0f65e5955be
              name: '{#FSNAME}: Used space in %'
              type: DEPENDENT
              key: 'vfs.fs.size[{#FSNAME},pused]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              units: '%'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              master_item:
                key: 'vfs.fs.size[{#FSNAME},pfree]'
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: 340900e00ea9441b93e77908a1721fdb
              name: '{#FSNAME}: Total space'
              key: 'vfs.fs.size[{#FSNAME},total]'
              history: 7d
              units: B
              description: 'Total space in Bytes'
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
            -
              uuid: 3dd95b9624e64a3b81ef6bdd24873e20
              name: '{#FSNAME}: Used space'
              type: CALCULATED
              key: 'vfs.fs.size[{#FSNAME},used]'
              history: 7d
              units: B
              params: 'last(//vfs.fs.size[{#FSNAME},total])-last(//vfs.fs.size[{#FSNAME},free])'
              tags:
                -
                  tag: Application
                  value: 'Filesystem {#FSNAME}'
                -
                  tag: component
                  value: storage
                -
                  tag: filesystem
                  value: '{#FSNAME}'
          trigger_prototypes:
            -
              uuid: 3485565b6aef4b63a24263a32cfdfc8e
              expression: 'max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"} and max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"} and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>0'
              name: 'Free disk space is critically low on volume {#FSNAME}'
              opdata: 'Free: {ITEM.LASTVALUE1} ({ITEM.LASTVALUE2}) of  {ITEM.LASTVALUE3} Total'
              priority: HIGH
              description: |
                Free space on volume {#FSNAME} host {HOST.NAME} is running out of disk space. 
                The values that exceeded the threshold are {ITEM.LASTVALUE1} free space and {ITEM.LASTVALUE2} free of {ITEM.LASTVALUE3}.
              manual_close: 'YES'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: capacity
            -
              uuid: 07e1c57d0b4f4955a30c22d39c38746b
              expression: |
                {$FREE.MBYTE.CONTROL:"{#FSNAME}"}=1 and 
                max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.MBYTE.CRIT:"{#FSNAME}"} 
                and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>=0
              name: 'Free disk space is less than {$VFS.FS.FREE.MBYTE.CRIT:"{#FSNAME}"} on volume {#FSNAME}'
              opdata: 'Free: {ITEM.LASTVALUE1} (of {ITEM.LASTVALUE2} Total)'
              priority: AVERAGE
              description: |
                Free space on volume {#FSNAME} host {HOST.NAME} is less than  {$VFS.FS.FREE.MBYTE.CRIT:"{#FSNAME}"}. 
                The values that exceeded the threshold are {ITEM.LASTVALUE1} free space of {ITEM.LASTVALUE2}.
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Free disk space is critically low on volume {#FSNAME}'
                  expression: 'max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"} and max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"} and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>0'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: capacity
            -
              uuid: 23c9668483c040f39c92dacfb38afa45
              expression: |
                max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"} 
                and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free])>=0 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>=0
              name: 'Free disk space is less than {$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"}% on volume {#FSNAME}'
              opdata: 'Free: {ITEM.LASTVALUE1} ({ITEM.LASTVALUE2} of {ITEM.LASTVALUE3} Total)'
              priority: AVERAGE
              description: |
                Free space on volume {#FSNAME} host {HOST.NAME} is running out of disk space. 
                The values that exceeded the threshold are {ITEM.LASTVALUE1} free space and {ITEM.LASTVALUE2} free of {ITEM.LASTVALUE3}.
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Free disk space is critically low on volume {#FSNAME}'
                  expression: 'max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.MIN.CRIT:"{#FSNAME}"} and max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"} and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>0'
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: capacity
            -
              uuid: 901479b6cbff415ba7f8a6246a3aa929
              expression: 'max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.WARN:"{#FSNAME}"} and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free])>=0 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>=0'
              name: 'Free disk space is less than {$VFS.FS.FREE.PERCENT.WARN:"{#FSNAME}"}% on volume {#FSNAME}'
              opdata: 'Free: {ITEM.LASTVALUE1} ({ITEM.LASTVALUE2} of {ITEM.LASTVALUE3} Total)'
              priority: WARNING
              description: |
                Free space on volume {#FSNAME} host {HOST.NAME} is running out of disk space. 
                The values that exceeded the threshold are {ITEM.LASTVALUE1} free space and {ITEM.LASTVALUE2} free of {ITEM.LASTVALUE3}.
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Free disk space is less than {$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"}% on volume {#FSNAME}'
                  expression: |
                    max(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},pfree],{$VFS.FS.INTERVAL})<{$VFS.FS.FREE.PERCENT.CRIT:"{#FSNAME}"} 
                    and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},free])>=0 and last(/POLYUS Template OS Linux by Zabbix agent/vfs.fs.size[{#FSNAME},total])>=0
              tags:
                -
                  tag: scope
                  value: availability
                -
                  tag: scope
                  value: capacity
          graph_prototypes:
            -
              uuid: 36abcd13a4484029aeffd0cae78e5a3a
              name: '{#FSNAME}: Disk space usage'
              width: '600'
              height: '340'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: PIE
              show_3d: 'YES'
              graph_items:
                -
                  color: 00FF00
                  calc_fnc: LAST
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.fs.size[{#FSNAME},free]'
                -
                  sortorder: '1'
                  color: FF0000
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'POLYUS Template OS Linux by Zabbix agent'
                    key: 'vfs.fs.size[{#FSNAME},total]'
      macros:
        -
          macro: '{$AGENT.TIMEOUT}'
          value: 5m
          description: 'Timeout after which agent is considered unavailable. Works only for agents reachable from Zabbix server/proxy (passive mode).'
        -
          macro: '{$CPU.LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '2.5'
          description: 'Load per CPU considered sustainable. Tune if needed.'
        -
          macro: '{$CPU.LOAD_AVG_PER_CPU.MAX.WARN.INTERVAL}'
          value: 5m
          description: '      "Load average is too high"'
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
          description: '    %'
        -
          macro: '{$CPU.UTIL.CRIT.SIEM}'
          value: '90'
          description: '      SIEM'
        -
          macro: '{$CPU.UTIL.CRIT.TIME.INTERVAL}'
          value: 15m
          description: ' ,        ,   '
        -
          macro: '{$CPU.UTIL.CRIT.TIME.INTERVAL.SIEM}'
          value: 5m
          description: '      SIEM'
        -
          macro: '{$FREE.MBYTE.CONTROL}'
          value: '0'
          description: '    .     "VFS.FS.FREE.MBYTE.CRIT". (    )'
        -
          macro: '{$KERNEL.MAXFILES.MIN}'
          value: '256'
        -
          macro: '{$KERNEL.MAXPROC.MIN}'
          value: '1024'
        -
          macro: '{$MEM.AVAILABLE.MIN}'
          value: 20M
          description: 'This macro is used as a threshold in memory available trigger.'
        -
          macro: '{$MEM.SWAP.FREE.MIN.CRIT}'
          value: 2.5M
        -
          macro: '{$MEM.SWAP.PFREE.MIN.WARN}'
          value: '0'
          description: ()
        -
          macro: '{$MEM.SWAP.PFREE.MIN.WARN.TIME.INTERVAL}'
          value: 30m
          description: ' ,        SWAP,   '
        -
          macro: '{$MEM.UTIL.CRIT.PERIOD}'
          value: 30m
        -
          macro: '{$MEM.UTIL.CRIT.PERIOD.SIEM}'
          value: 5m
          description: '      SIEM'
        -
          macro: '{$MEM.UTIL.MAX}'
          value: '90'
          description: 'This macro is used as a threshold in memory utilization trigger.'
        -
          macro: '{$MEM.UTIL.MAX.SIEM}'
          value: '90'
          description: '      SIEM'
        -
          macro: '{$NET.IF.CONTROL}'
          value: '1'
        -
          macro: '{$NET.IF.ERRORS.WARN}'
          value: '10'
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9A-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        -
          macro: '{$NET.IF.UTIL.MAX}'
          value: '90'
          description: 'This macro is used as a threshold in interface utilization trigger.'
        -
          macro: '{$SYSTEM.FUZZYTIME.MAX}'
          value: '60'
        -
          macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: .+
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: '^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*|veeamimage[0-9]+|blksnap-image[0-9]+|cdrom$|cdrw$|dvd$)'
          description: 'This macro is used in block devices discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.DEV.READ.AWAIT.WARN}'
          value: '20'
          description: 'Disk read average response time (in ms) before the trigger would fire'
        -
          macro: '{$VFS.DEV.WRITE.AWAIT.WARN}'
          value: '20'
          description: 'Disk write average response time (in ms) before the trigger would fire'
        -
          macro: '{$VFS.FS.FREE.MBYTE.CRIT}'
          value: 100G
          description: '    ,   . (    )'
        -
          macro: '{$VFS.FS.FREE.MIN.CRIT}'
          value: 500M
          description: '  .       ()'
        -
          macro: '{$VFS.FS.FREE.PERCENT.CRIT}'
          value: '10'
          description: '     %. (    )'
        -
          macro: '{$VFS.FS.FREE.PERCENT.WARN}'
          value: '0'
          description: '()      %. (    )'
        -
          macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/.snapshots|/tmp/veeam|/dev|/sys|/srv|/run|/proc|.+/shm$)
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: ^(btrfs|ext2|ext3|ext4|reiser|xfs|ffs|ufs|jfs|jfs2|vxfs|hfs|apfs|refs|ntfs|fat32|zfs|nfs4)$
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'This macro is used in filesystems discovery. Can be overridden on the host or linked template level'
        -
          macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
          value: '10'
        -
          macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
          value: '20'
        -
          macro: '{$VFS.FS.INTERVAL}'
          value: 5m
          description: '      '
      dashboards:
        -
          uuid: 5e3d1c47419f44bda1b255e8a4668c71
          name: 'System performance'
          pages:
            -
              widgets:
                -
                  type: GRAPH_CLASSIC
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: 'System load'
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: 'CPU usage'
                -
                  type: GRAPH_CLASSIC
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: 'Memory usage'
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: 'Swap usage'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '10'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: '{#FSNAME}: Disk space usage'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '15'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: '{#DEVNAME}: Disk read/write rates'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '20'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: '{#DEVNAME}: Disk average waiting time'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '25'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: '{#DEVNAME}: Disk utilization and queue'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '30'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'POLYUS Template OS Linux by Zabbix agent'
                        name: 'Interface {#IFNAME}: Network traffic'
      valuemaps:
        -
          uuid: 06253f0a7f994d3f8f74996f540adeaf
          name: ifOperStatus
          mappings:
            -
              value: '0'
              newvalue: unknown
            -
              value: '1'
              newvalue: notpresent
            -
              value: '2'
              newvalue: down
            -
              value: '3'
              newvalue: lowerlayerdown
            -
              value: '4'
              newvalue: testing
            -
              value: '5'
              newvalue: dormant
            -
              value: '6'
              newvalue: up
        -
          uuid: cd980c77be454557b36906a742222cbc
          name: 'Linux::Interface protocol types'
          mappings:
            -
              value: '0'
              newvalue: 'from KA9Q: NET/ROM pseudo'
            -
              value: '1'
              newvalue: Ethernet
            -
              value: '2'
              newvalue: 'Experimental Ethernet'
            -
              value: '3'
              newvalue: 'AX.25 Level 2'
            -
              value: '4'
              newvalue: 'PROnet token ring'
            -
              value: '5'
              newvalue: Chaosnet
            -
              value: '6'
              newvalue: 'IEEE 802.2 Ethernet/TR/TB'
            -
              value: '7'
              newvalue: ARCnet
            -
              value: '8'
              newvalue: APPLEtalk
            -
              value: '15'
              newvalue: 'Frame Relay DLCI'
            -
              value: '19'
              newvalue: ATM
            -
              value: '23'
              newvalue: 'Metricom STRIP (new IANA id)'
            -
              value: '24'
              newvalue: 'IEEE 1394 IPv4 - RFC 2734'
            -
              value: '27'
              newvalue: EUI-64
            -
              value: '32'
              newvalue: InfiniBand
            -
              value: '256'
              newvalue: ARPHRD_SLIP
            -
              value: '257'
              newvalue: ARPHRD_CSLIP
            -
              value: '258'
              newvalue: ARPHRD_SLIP6
            -
              value: '259'
              newvalue: ARPHRD_CSLIP6
            -
              value: '260'
              newvalue: 'Notional KISS type'
            -
              value: '264'
              newvalue: ARPHRD_ADAPT
            -
              value: '270'
              newvalue: ARPHRD_ROSE
            -
              value: '271'
              newvalue: 'CCITT X.25'
            -
              value: '272'
              newvalue: 'Boards with X.25 in firmware'
            -
              value: '280'
              newvalue: 'Controller Area Network'
            -
              value: '512'
              newvalue: ARPHRD_PPP
            -
              value: '513'
              newvalue: 'Cisco HDLC'
            -
              value: '516'
              newvalue: LAPB
            -
              value: '517'
              newvalue: 'Digital''s DDCMP protocol'
            -
              value: '518'
              newvalue: 'Raw HDLC'
            -
              value: '519'
              newvalue: 'Raw IP'
            -
              value: '768'
              newvalue: 'IPIP tunnel'
            -
              value: '769'
              newvalue: 'IP6IP6 tunnel'
            -
              value: '770'
              newvalue: 'Frame Relay Access Device'
            -
              value: '771'
              newvalue: 'SKIP vif'
            -
              value: '772'
              newvalue: 'Loopback device'
            -
              value: '773'
              newvalue: 'Localtalk device'
            -
              value: '774'
              newvalue: 'Fiber Distributed Data Interface'
            -
              value: '775'
              newvalue: 'AP1000 BIF'
            -
              value: '776'
              newvalue: 'sit0 device - IPv6-in-IPv4'
            -
              value: '777'
              newvalue: 'IP over DDP tunneller'
            -
              value: '778'
              newvalue: 'GRE over IP'
            -
              value: '779'
              newvalue: 'PIMSM register interface'
            -
              value: '780'
              newvalue: 'High Performance Parallel Interface'
            -
              value: '781'
              newvalue: 'Nexus 64Mbps Ash'
            -
              value: '782'
              newvalue: 'Acorn Econet'
            -
              value: '783'
              newvalue: Linux-IrDA
            -
              value: '784'
              newvalue: 'Point to point fibrechannel'
            -
              value: '785'
              newvalue: 'Fibrechannel arbitrated loop'
            -
              value: '786'
              newvalue: 'Fibrechannel public loop'
            -
              value: '787'
              newvalue: 'Fibrechannel fabric'
            -
              value: '800'
              newvalue: 'Magic type ident for TR'
            -
              value: '801'
              newvalue: 'IEEE 802.11'
            -
              value: '802'
              newvalue: 'IEEE 802.11 + Prism2 header'
            -
              value: '803'
              newvalue: 'IEEE 802.11 + radiotap header'
            -
              value: '804'
              newvalue: ARPHRD_IEEE802154
            -
              value: '805'
              newvalue: 'IEEE 802.15.4 network monitor'
            -
              value: '820'
              newvalue: 'PhoNet media type'
            -
              value: '821'
              newvalue: 'PhoNet pipe header'
            -
              value: '822'
              newvalue: 'CAIF media type'
            -
              value: '823'
              newvalue: 'GRE over IPv6'
            -
              value: '824'
              newvalue: 'Netlink header'
            -
              value: '825'
              newvalue: 'IPv6 over LoWPAN'
            -
              value: '826'
              newvalue: 'Vsock monitor header'
        -
          uuid: 25c54a3c2bd440f88f10afb8cfc0dee2
          name: 'Service state'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
        -
          uuid: 77e41a4706204b2e940b8a7a876e3700
          name: zabbix.host.available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
        -
          uuid: db383fc586a145a39183794f24304ff7
          name: 'Zabbix agent ping status'
          mappings:
            -
              value: '1'
              newvalue: Up
  triggers:
    -
      uuid: fecbd7700d374c5d936e1b3e6d9352e8
      expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[available],5m)<{$MEM.AVAILABLE.MIN} and last(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[total])>0'
      name: 'Available Megabytes of Memory is too low'
      opdata: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      tags:
        -
          tag: scope
          value: performance
    -
      uuid: f071893f4da34a3fb2c2253f331fb6bf
      expression: 'min(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,free],5m)<{$MEM.SWAP.FREE.MIN.CRIT} and last(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,total])>0'
      name: 'Available Megabytes Swap Space is too low'
      opdata: 'Free: {ITEM.LASTVALUE1}'
      priority: WARNING
      description: 'Last value: {ITEM.LASTVALUE1}'
      manual_close: 'YES'
      tags:
        -
          tag: scope
          value: capacity
    -
      uuid: 6598fb01171048ee9dea6543f3826943
      expression: 'last(/POLYUS Template OS Linux by Zabbix agent/proc.num)/last(/POLYUS Template OS Linux by Zabbix agent/kernel.maxproc)*100>80'
      name: 'Getting closer to process limit (over 80% used)'
      opdata: '{ITEM.LASTVALUE1} active, {ITEM.LASTVALUE2} limit.'
      priority: WARNING
      tags:
        -
          tag: scope
          value: performance
    -
      uuid: c67ee97748514476bfaa3abe717f99e4
      expression: |
        min(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,pfree],{$MEM.SWAP.PFREE.MIN.WARN.TIME.INTERVAL})<{$MEM.SWAP.PFREE.MIN.WARN} and last(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,total])>0 
        and {$MEM.SWAP.PFREE.MIN.WARN}>0
      name: 'High swap space usage ( less than {$MEM.SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'This trigger is ignored, if there is no swap configured'
      dependencies:
        -
          name: 'Available Megabytes of Memory is too low'
          expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[available],5m)<{$MEM.AVAILABLE.MIN} and last(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[total])>0'
        -
          name: 'Available Megabytes Swap Space is too low'
          expression: 'min(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,free],5m)<{$MEM.SWAP.FREE.MIN.CRIT} and last(/POLYUS Template OS Linux by Zabbix agent/system.swap.size[,total])>0'
        -
          name: 'High memory utilization ( >{$MEM.UTIL.MAX}% for {$MEM.UTIL.CRIT.PERIOD})'
          expression: 'min(/POLYUS Template OS Linux by Zabbix agent/vm.memory.size[pavailable],{$MEM.UTIL.CRIT.PERIOD})>{$MEM.UTIL.MAX}'
      tags:
        -
          tag: scope
          value: capacity
    -
      uuid: 3b7a915f86ae4cc0bfc44309082b0fb0
      expression: |
        min(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg1],{$CPU.LOAD_AVG_PER_CPU.MAX.WARN.INTERVAL})/last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.num)>{$CPU.LOAD_AVG_PER_CPU.MAX.WARN}
        and last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg5])>0
        and last(/POLYUS Template OS Linux by Zabbix agent/system.cpu.load[all,avg15])>0
      name: 'Load average is too high (per CPU load over {$CPU.LOAD_AVG_PER_CPU.MAX.WARN} for {$CPU.LOAD_AVG_PER_CPU.MAX.WARN.INTERVAL})'
      opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'Per CPU load average is too high. Your system may be slow to respond.'
      manual_close: 'YES'
      tags:
        -
          tag: scope
          value: capacity
        -
          tag: scope
          value: performance
  graphs:
    -
      uuid: fc44b3bad5774f9780f6483360e7c22e
      name: 'CPU jumps'
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: system.cpu.switches
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: system.cpu.intr
    -
      uuid: 8c4446f5c1aa4e1e89d955cf5674bea2
      name: 'CPU usage'
      type: STACKED
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,system]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,user]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,nice]'
        -
          sortorder: '3'
          color: A54F10
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,iowait]'
        -
          sortorder: '4'
          color: FC6EA3
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,steal]'
        -
          sortorder: '5'
          color: 6C59DC
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,interrupt]'
        -
          sortorder: '6'
          color: AC8C14
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,softirq]'
        -
          sortorder: '7'
          color: 611F27
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,guest]'
        -
          sortorder: '8'
          color: F230E0
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.util[,guest_nice]'
    -
      uuid: 42c95c0a6b914255a74bb996a2dbeb9f
      name: 'CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: system.cpu.util
    -
      uuid: 080e8beeae3a422ca496da083de33a75
      name: 'Memory usage'
      ymin_type_1: FIXED
      graph_items:
        -
          drawtype: BOLD_LINE
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'vm.memory.size[total]'
        -
          sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'vm.memory.size[available]'
    -
      uuid: 5b44d34bd64a4dddb1a2292addd50c22
      name: 'Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'vm.memory.size[pavailable]'
    -
      uuid: 7477750fcb36400ca193b14af0c8a12c
      name: Processes
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: proc.num
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'proc.num[,,run]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: kernel.maxproc
    -
      uuid: 988a3ec35b9c4855991d5071d5bfeb62
      name: 'Swap usage'
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.swap.size[,free]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.swap.size[,total]'
    -
      uuid: f617dff81a004da9a6cfb70d09906d76
      name: 'System load'
      ymin_type_1: FIXED
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.load[all,avg1]'
        -
          sortorder: '1'
          color: 2774A4
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.load[all,avg5]'
        -
          sortorder: '2'
          color: F63100
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: 'system.cpu.load[all,avg15]'
        -
          sortorder: '3'
          color: A54F10
          yaxisside: RIGHT
          item:
            host: 'POLYUS Template OS Linux by Zabbix agent'
            key: system.cpu.num
